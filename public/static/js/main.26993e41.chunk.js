(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{115:function(e,t,n){e.exports=n(268)},120:function(e,t,n){},171:function(e,t){},268:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(27),c=n.n(o),i=(n(120),n(11)),s=n(2),l=n(3),u=n(5),d=n(4),m=n(20),p=n(7),f=n(8),h=n.n(f),v=n(10),b=n(17),g=Object(b.a)(),E=n(28),y=n.n(E),C=y.a.create({withCredentials:!0}),k=function(e,t){return S(e,"GET",t)},w=function(e,t){return S(e,"POST",t)},N=function(e,t){return S(e,"PUT",t)},B=function(e,t){return S(e,"DELETE",t)};function S(e){return O.apply(this,arguments)}function O(){return(O=Object(v.a)(h.a.mark((function e(t){var n,a,r,o=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"get",a=o.length>2&&void 0!==o[2]?o[2]:null,e.prev=2,e.next=5,C({url:"".concat("/api/").concat(t),method:n,data:a});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(n,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(a)),console.dir(e.t0),e.t0.response&&401===e.t0.response.status&&g.push("/login"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var M,x=n(109),j=n.n(x),L={setup:function(){M=j()("/")},terminate:function(){M=null},on:function(e,t){M.on(e,t)},off:function(e,t){M.off(e,t)},emit:function(e,t){M.emit(e,t)}};var D={login:function(e){return U.apply(this,arguments)},logout:function(e){return I.apply(this,arguments)},signup:function(e){return T.apply(this,arguments)},getUsers:function(){return k("user")},getById:function(e){return k("user/".concat(e))},remove:function(e){return B("user/".concat(e))},update:A,getUserFromSession:function(){return _.apply(this,arguments)},clearNotifications:function(e){e.notifications.map((function(e){return e.isRead=!0})),A(e)}};function A(e){return console.log("Update",e),N("user/".concat(e._id),e)}function U(){return(U=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/login",t);case 2:return n=e.sent,e.abrupt("return",F(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/signup",t);case 2:return n=e.sent,e.abrupt("return",F(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLogIn=!1,e.next=3,A(t);case 3:return L.off("user-invite-".concat(t._id)),L.off("user-card-assign-".concat(t._id)),e.next=7,w("auth/logout");case 7:return n=e.sent,sessionStorage.clear(),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return e.isLogIn=!0,A(e),L.emit("user login"),sessionStorage.setItem("user",JSON.stringify(e)),e}function _(){return(_=Object(v.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k("auth/session");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return function(){var e=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D.getUsers();case 3:n=e.sent,t(z(n)),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}function H(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.login(e);case 2:a=t.sent,n(V(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function R(){return function(){var e=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.getUserFromSession();case 2:n=e.sent,t(V(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function W(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.update(e);case 2:a=t.sent,n(V(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function V(e){return{type:"SET_USER",user:e}}function z(e){return{type:"SET_USERS",users:e}}var J=n(15),q=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={username:null,password:null},e.inputHandler=function(t){var n=t.target,a=n.name,r=n.value;e.setState(Object(m.a)({},a,r))},e.onSubmit=function(t){t.preventDefault();var n=e.state,a={username:n.username,password:n.password};e.props.login(a).then((function(){e.props.history.push("/board")})).catch(console.log("ERROR"))},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"login-container flex column space-between align-center"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{className:"flex column space-between",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",placeholder:"username",name:"username",autoComplete:"off",onChange:this.inputHandler}),r.a.createElement("input",{type:"password",placeholder:"Password",name:"password",onChange:this.inputHandler}),r.a.createElement("button",null,"Login")),r.a.createElement("p",null,"Don't have an account?",r.a.createElement(J.b,{to:"/signup"},"signup")))}}]),n}(r.a.Component),K={login:H},G=Object(p.b)(null,K)(q),X=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={fullName:null,password:null,username:null},e.inputHandler=function(t){var n=t.target,a=n.name,r=n.value;e.setState(Object(m.a)({},a,r))},e.onSubmit=function(t){t.preventDefault();var n=e.state,a=n.fullName,r={password:n.password,fullName:a,username:n.username,isGuest:!1};e.props.signup(r).then((function(){return e.props.history.push("/board")})).catch((function(e){return console.log(e)}))},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"signup-container flex column space-between align-center"},r.a.createElement("h2",null,"Signup"),r.a.createElement("form",{className:"flex column space-between",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",placeholder:"Full name",name:"fullName",onChange:this.inputHandler,required:!0}),r.a.createElement("input",{type:"text",placeholder:"username",name:"username",onChange:this.inputHandler,required:!0}),r.a.createElement("input",{type:"password",placeholder:"Password",name:"password",onChange:this.inputHandler,required:!0}),r.a.createElement("button",null,"Signup")),r.a.createElement("p",null,"Already have an account? ",r.a.createElement(J.b,{to:"/login"},"login")))}}]),n}(r.a.Component),Q={signup:function(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.signup(e);case 2:a=t.sent,n(V(a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},$=Object(p.b)(null,Q)(X),Y=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onDemoClick=function(){e.props.login({username:"guest",password:"guest"})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.getUser().then((function(){e.props.loggedUser&&e.props.history.push("/board")}))}},{key:"componentDidUpdate",value:function(){this.props.loggedUser&&this.props.history.push("/board")}},{key:"render",value:function(){return r.a.createElement("div",{className:"home-container"},r.a.createElement("div",{className:"wallpaper"}),r.a.createElement("div",{className:"home-content-wrapper flex"},r.a.createElement("div",{className:"home-pitch flex column justify-center align-center"},r.a.createElement("div",{className:"home-description-wrapper"},r.a.createElement("h3",{className:"line-a"},"Taskerr"),r.a.createElement("h3",{className:"line-b"},"Like Trello,"),r.a.createElement("h3",{className:"line-c"},"Just better."),r.a.createElement("div",{className:"demo-btn flex align-center justify-center",onClick:this.onDemoClick},"Guest mode"))),r.a.createElement("div",{className:"home-login-container flex justify-center align-center"},r.a.createElement(i.c,null,r.a.createElement(i.a,{component:$,path:"/signup"}),r.a.createElement(i.a,{component:G,path:"/"})))))}}]),n}(r.a.Component),Z={login:H,getUser:R},ee=Object(p.b)((function(e){return{loggedUser:e.user.loggedInUser}}),Z)(Y),te=n(9),ne="/api/board",ae=y.a.create({withCredentials:!0}),re={query:function(e){return ae.get(ne,{params:Object(te.a)({},e)}).then((function(e){return e.data}))},get:function(e){return ae.get("".concat(ne,"/").concat(e)).then((function(e){return e.data}))},remove:function(e){return ae.delete("".concat(ne,"/").concat(e))},save:function(e){var t;t=e._id?ae.put("".concat(ne,"/").concat(e._id),e):ae.post(ne,e);return t.then((function(e){return e.data}))}};function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){var t=Object(v.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,re.query(e);case 3:return a=t.sent,t.abrupt("return",n({type:"SET_BOARDS",boards:a}));case 7:t.prev=7,t.t0=t.catch(0),console.log("boardAction: error in setBoards:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function ce(){return function(){var e=Object(v.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t({type:"RESET_BOARD"}));case 4:e.prev=4,e.t0=e.catch(0),console.log("Dont earse currBoard",e.t0);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t){return e.apply(this,arguments)}}()}function ie(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){var a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,re.get(e);case 3:return a=t.sent,t.abrupt("return",n({type:"SET_BOARD",board:a}));case 7:t.prev=7,t.t0=t.catch(0),console.log("boardAction: error in setBoard:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}function se(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,re.remove(e);case 3:n({type:"REMOVE_BOARD",boardId:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log("boardAction: error in removeBoard:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()}function le(e){return function(){var t=Object(v.a)(h.a.mark((function t(n){var a,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e._id?"UPDATE_BOARD":"ADD_BOARD",t.next=4,re.save(e);case 4:return r=t.sent,L.emit("board updated",e._id),t.abrupt("return",n({type:a,board:r}));case 9:t.prev=9,t.t0=t.catch(0),console.log("boardAction: error in saveBoard:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}function ue(e){var t="https://api.cloudinary.com/v1_1/".concat("dt3cfrjpr","/image/upload"),n=Object.values(e.target.files).map((function(e){var n=new FormData;return n.append("file",e),n.append("upload_preset","rvddiiry"),y.a.post(t,n).then((function(e){return e.data})).then((function(e){return e})).catch((function(e){return console.log(e)}))}));return Promise.all(n)}var de=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={title:"",editTitleMode:!1,isImgLoading:!1,updateCoverMode:!1},e.closeBoardMenu=function(t){var n=e.props.closeMenu;e.node.contains(t.target)&&27!==t.keyCode||n()},e.activeEditMode=function(t){t.stopPropagation(),e.setState({editTitleMode:!0})},e.handleChange=function(t){t.stopPropagation(),e.setState({title:t.target.value})},e.handleSubmit=function(t){t.preventDefault();var n=e.props,a=n.saveBoard,r=n.closeMenu,o=n.clearCurrBoard,c=e.props.board;c.title=e.state.title,a(c).then((function(){return o()})),e.setState({editTitleMode:!1}),r()},e.onRemoveBoard=function(t){t.stopPropagation();var n=e.props,a=n.board;(0,n.removeBoard)(a._id)},e.openCoverMode=function(){e.setState({coverMode:!0})},e.closeCoverMode=function(){e.setState({coverMode:!1})},e.onUploadImg=function(t){var n=e.props,a=n.saveBoard,r=n.closeMenu,o=n.clearCurrBoard;e.setState({isImgLoading:!0});var c=e.props.board;ue(t).then((function(t){c.background.content=t[0].url,a(c).then((function(){return o()})),e.setState({isImgLoading:!1}),r()})).catch((function(){return e.setState({isImgLoading:!1})}))},e.onChangeColor=function(t){var n=e.props,a=n.saveBoard,r=n.closeMenu,o=n.clearCurrBoard,c=e.props.board;c.background.color=t,c.background.content="",a(c).then((function(){return o()})),r()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeBoardMenu,!1),document.addEventListener("keydown",this.closeBoardMenu,!1);var e=this.props.board;this.setState({title:e.title})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeBoardMenu,!1),document.removeEventListener("keydown",this.closeBoardMenu,!1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.editTitleMode,a=t.title,o=t.isImgLoading,c=t.coverMode;return r.a.createElement("div",{ref:function(t){return e.node=t},className:"board-menu-container flex column space-between ".concat(o&&"box-shadow-off")},o?r.a.createElement("div",{className:"loading"}):r.a.createElement(r.a.Fragment,null,n?r.a.createElement("form",{className:"flex",onSubmit:this.handleSubmit},r.a.createElement("input",{value:a,onChange:this.handleChange,onBlur:this.handleSubmit,onClick:function(e){return e.stopPropagation()},autoFocus:!0,spellCheck:"false"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{onClick:this.activeEditMode},"Edit Title"),r.a.createElement("div",{className:"update-cover-btn",onClick:function(e){return e.stopPropagation()},onMouseOver:this.openCoverMode,onMouseLeave:this.closeCoverMode},"Update cover",c&&r.a.createElement("div",{className:"change-cover-wrap flex column"},r.a.createElement("div",{className:"color-palette flex"},r.a.createElement("div",{onClick:function(){return e.onChangeColor("#e74c3c")}},"\u2b24"),r.a.createElement("div",{onClick:function(){return e.onChangeColor("#e67e22")}},"\u2b24"),r.a.createElement("div",{onClick:function(){return e.onChangeColor("#f1c40f")}},"\u2b24"),r.a.createElement("div",{onClick:function(){return e.onChangeColor("#27ae60")}},"\u2b24"),r.a.createElement("div",{onClick:function(){return e.onChangeColor("#2980b9")}},"\u2b24"),r.a.createElement("div",{onClick:function(){return e.onChangeColor("#8e44ad")}},"\u2b24")),r.a.createElement("label",null,r.a.createElement("div",{className:"upload-pic-btn"},"Upload Image",r.a.createElement("input",{onChange:this.onUploadImg,type:"file",hidden:!0,accept:"image/png, image/jpeg"}))))),r.a.createElement("div",{className:"delete-btn",onClick:this.onRemoveBoard},"Delete Board"))))}}]),n}(r.a.Component),me={saveBoard:le,removeBoard:se},pe=Object(p.b)(null,me)(de),fe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isModalOpen:!1},e.openMenu=function(t){t.stopPropagation(),e.setState({isModalOpen:!0})},e.closeMenu=function(){e.setState({isModalOpen:!1})},e}return Object(l.a)(n,[{key:"getBackground",value:function(e){return e.background.content?{backgroundImage:"url("+"".concat(e.background.content)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{background:e.background.color}}},{key:"starToggle",value:function(e,t){var n=this.props,a=n.saveBoard,r=n.clearCurrBoard;t.stopPropagation(),e.isStarred=!e.isStarred,a(e).then((function(){return r()}))}},{key:"render",value:function(){var e=this,t=this.state.isModalOpen,n=this.props,a=n.board,o=n.onBoardClicked,c=n.clearCurrBoard,i=n.editable;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"board",onClick:function(){return o(a._id)},style:this.getBackground(a)},r.a.createElement("h3",null,a.title),i&&r.a.createElement("div",{className:"fs24 ".concat(a.isStarred?"starred":"not-starred"),onClick:function(t){return e.starToggle(a,t)}}),i&&r.a.createElement("div",{className:"menu-btn",onClick:this.openMenu}),t&&r.a.createElement(pe,{closeMenu:this.closeMenu,board:a,clearCurrBoard:c})))}}]),n}(r.a.Component),he=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={addBoardForm:!1,newBoardTitle:""},e.escFunction=function(t){27===t.keyCode&&e.setState({addBoardForm:!1,newBoardTitle:""})},e.openForm=function(){e.setState({addBoardForm:!0})},e.handleChange=function(t){var n=t.target.value;e.setState({newBoardTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.createNewBoard()},e.handleBlur=function(){e.state.newBoardTitle?e.createNewBoard():e.setState({addBoardForm:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"createNewBoard",value:function(){var e={title:this.state.newBoardTitle};this.props.saveBoard(e),this.setState({addBoardForm:!1,newBoardTitle:""})}},{key:"render",value:function(){var e=this.props,t=e.boards,n=e.onBoardClicked,a=e.saveBoard,o=e.addBoardOption,c=e.clearCurrBoard,i=e.history,s=e.editable,l=this.state,u=l.addBoardForm,d=l.newBoardTitle;return r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement(fe,{history:i,key:e._id,board:e,onBoardClicked:n,saveBoard:a,clearCurrBoard:c,editable:s})})),o&&r.a.createElement("div",{className:"board add-board flex justify-center align-center",onClick:this.openForm},u?r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Board title...",value:d,onChange:this.handleChange,autoFocus:!0,onBlur:this.handleBlur})):r.a.createElement("h3",null,"Create new board")))}}]),n}(r.a.Component),ve=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).inputHandler=function(t){var n=t.target;e.props.onFilter(n.value)},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"nav-menu-filter flex justify-center align-center"},r.a.createElement("input",{className:"board-search",autoComplete:"off",type:"text",name:"keyword",placeholder:"Search a board",onChange:this.inputHandler}))}}]),n}(r.a.Component),be=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={filteredBoards:null},e.onBoardClicked=function(t){e.props.history.push("/board/".concat(t)),e.props.setBoard(t),e.props.onPageChange()},e.onFilter=function(t){if(t.length){var n=e.props.boards.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));e.setState({filteredBoards:n})}else e.setState({filteredBoards:null})},e.onHomeBtnClick=function(){e.props.history.push("/board"),e.props.onPageChange()},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.currBoard,a=t.boards,o=t.isMenuActive,c=this.state.filteredBoards,i=a.filter((function(e){return e.isStarred}));return r.a.createElement("div",{className:"nav-menu flex column  ".concat(o?"nav-open":"")},n&&r.a.createElement("div",{className:"home-button flex align-center justify-center cursor",onClick:function(){return e.onHomeBtnClick()}},r.a.createElement("div",{className:"dashboard-btn"}),r.a.createElement("div",{className:"flex align-center justify-center"},"Dashboard")),r.a.createElement(ve,{onFilter:function(t){return e.onFilter(t)}}),r.a.createElement("div",{className:"nav-boards-preview-wrapper flex column"},r.a.createElement("div",{className:"nav-board-preview-overlay"}),c&&r.a.createElement("h3",{className:"list-header"},"Searched Boards"),c&&!c.length&&r.a.createElement("h4",{className:"no-match"},"- There is no matches"),c&&r.a.createElement("div",{className:"boards-container flex column align-center"},r.a.createElement(he,{boards:c,onBoardClicked:this.onBoardClicked})),Boolean(a.length)&&r.a.createElement("div",null,Boolean(i.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"list-header"},"Starred"),r.a.createElement("div",{className:"boards-container flex column align-center"},r.a.createElement(he,{boards:i,onBoardClicked:this.onBoardClicked}))," "),r.a.createElement("div",null,r.a.createElement("h3",{className:"list-header"},"All Boards")),r.a.createElement("div",{className:"boards-container flex column align-center"},r.a.createElement(he,{boards:a,onBoardClicked:this.onBoardClicked})))))}}]),n}(r.a.Component),ge={setBoards:oe,setBoard:ie},Ee=Object(p.b)(null,ge)(Object(i.f)(be));function ye(e){var t=e.notifications,n=e.history;e.isShown;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"notifications-header flex align-center justify-center"},r.a.createElement("div",{className:"history-back-btn",onClick:function(){return e.goBack()}}),r.a.createElement("h3",null,"History")),r.a.createElement("div",{className:"nav-notifications-wrapper flex column align-center"},t.map((function(e,t){return r.a.createElement("div",{className:"user-notification flex align-center space-between",key:t,onClick:function(t){t.stopPropagation(),n.push("".concat(e.url))}},r.a.createElement("p",null,e.content))}))))}function Ce(e){return r.a.createElement("div",{className:"notifications-all-read flex column align-center"},r.a.createElement("img",{className:"notification-nodata"}),r.a.createElement("h3",null,"All set! No Unread Notifications"),r.a.createElement("span",{className:"notifi-history-btn",onClick:function(){return e.showHistory()}},"View history"))}function ke(e){var t=e.user.notifications.filter((function(e){return!e.isRead}));return r.a.createElement("div",{className:"nav-notifications-wrapper flex column align-center"},r.a.createElement("span",{className:"card-notification-clear",onClick:function(){return e.markAsRead()}}),t.map((function(t,n){return"board-collab"===t.type?r.a.createElement("div",{className:"user-notification flex align-start",key:n},r.a.createElement("p",null,t.data),r.a.createElement("div",{className:"board-collab-btns flex column space-around"},r.a.createElement("button",{onClick:function(){return e.onBoardCollab(t,n)}},"Join"),r.a.createElement("button",{onClick:function(){return e.onInviteDecline(n)}},"Decline"))):"card-assign"===t.type?r.a.createElement("div",{className:"user-notification flex column",key:n},r.a.createElement("p",{className:"card-assign-content"},t.data),r.a.createElement(J.b,{className:"notification-card-link",onClick:function(){return e.onViewCard(n)},to:"/board/".concat(t.boardId,"/").concat(t.cardId)},"View Card")):r.a.createElement("div",{className:"user-notification flex align-center space-between",key:n},r.a.createElement("p",null,t.data),r.a.createElement(J.b,{className:"notification-link",to:t.url},"Details"))})))}var we=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isHistoryShown:!1},e.onCloseNotificationMenu=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.props.onCloseNotificationMenu()},e.onClearNotification=function(){var t=e.props.loggedUser;D.clearNotifications(t),e.props.update(t)},e.onNotificationsHistory=function(){e.setState((function(e){return{isHistoryShown:!e.isHistoryShown}}))},e.onBoardCollab=function(){var t=Object(v.a)(h.a.mark((function t(n,a){var r,o,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(te.a)({},e.props.loggedUser),t.next=3,re.get(n.collabBoardId);case 3:return o=t.sent,(c=o.members.find((function(e){return e._id===r._id})))||o.members.push({_id:r._id,imgUrl:r.imgUrl,userName:r.userName,fullName:r.fullName}),r.notifications=r.notifications.filter((function(e,t){return t!==a})),t.next=9,e.props.update(r);case 9:return t.next=11,e.props.saveBoard(o);case 11:e.props.onCloseNotificationMenu(),c||e.props.history.push("/board/".concat(o._id));case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.onInviteDecline=function(t){var n=e.props.loggedUser;n.notifications.splice(t,1),e.props.update(n)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.getUser(),document.addEventListener("mousedown",this.onCloseNotificationMenu,!1),document.addEventListener("keydown",this.onCloseNotificationMenu,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onCloseNotificationMenu,!1),document.removeEventListener("keydown",this.onCloseNotificationMenu,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.loggedUser,a=t.isNotificationModalOpen,o=this.state.isHistoryShown,c=n.notifications.filter((function(e){return!e.isRead}));return r.a.createElement("div",{ref:function(t){return e.node=t}},r.a.createElement("div",{className:"nav-user-notifications-container ".concat(a?"modal-open":""," flex column align-center")},o&&r.a.createElement(ye,{isShown:a,goBack:this.onNotificationsHistory,notifications:n.notifications,history:this.props.history}),!o&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"notifications-header"},r.a.createElement("h3",null,"Notifications")),c.length?r.a.createElement(ke,{onViewCard:function(t){return e.props.onViewCardNotification(t)},onInviteDecline:this.onInviteDecline,markAsRead:this.onClearNotification,notifications:c,onBoardCollab:this.onBoardCollab,user:n}):r.a.createElement(Ce,{showHistory:this.onNotificationsHistory}))))}}]),n}(a.Component),Ne={saveBoard:le,getUser:R,update:W,setUser:V},Be=Object(p.b)((function(e){return{loggedUser:e.user.loggedInUser}}),Ne)(we);function Se(e){var t=e.board,n=e.history,a=e.cardMemberMode;return r.a.createElement("div",{className:"nav-board-members flex align-center"},t.members.map((function(e,t){return e.imgUrl?r.a.createElement("div",{key:t,className:"board-member",style:{backgroundImage:"url("+"".concat(e.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},onClick:function(){return n.push("/user/".concat(e._id))}},r.a.createElement("div",{className:"board-member-tooltip"},r.a.createElement("p",null,e.fullName))):r.a.createElement("h3",{className:"nav-user-profile flex justify-center align-center"},e.fullName.charAt(0))})),!a&&r.a.createElement("button",{className:"nav-user-profile invite flex align-center justify-center index-1",onClick:function(){return e.onInvite()}},r.a.createElement("div",{className:"plus-white flex align-center justify-center"})),r.a.createElement("div",{className:"flex align-center"}))}var Oe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isUserModalOpen:!1},e.onCloseUserModal=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.setState({isUserModalOpen:!1})},e.onUserClick=function(t){t.stopPropagation(),e.setState((function(e){return{isUserModalOpen:!e.isUserModalOpen}}))},e.onUserLogOut=function(){var t=Object(v.a)(h.a.mark((function t(n){var a,r,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.stopPropagation(),a=e.props,r=a.history,o=a.user,t.next=4,D.logout(o);case 4:L.emit("user log-out-ui"),r.push("/");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onCloseUserModal,!1),document.addEventListener("keydown",this.onCloseUserModal,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onCloseUserModal,!1),document.removeEventListener("keydown",this.onCloseUserModal,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.history,o=this.onUserClick,c=this.onUserLogOut,i=this.state.isUserModalOpen;return r.a.createElement("div",{className:"user-preview",ref:function(t){return e.node=t},onClick:o},n.imgUrl?r.a.createElement("div",{className:"board-member",style:{backgroundImage:"url("+"".concat(n.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}):r.a.createElement("h3",{className:"nav-user-profile flex justify-center align-center"},n.fullName.charAt(0)),r.a.createElement("div",{className:"member-modal ".concat(i?"modal-open":"")},r.a.createElement("div",{onClick:function(){return a.push("/user/".concat(n._id))}}," My details "),r.a.createElement("div",{onClick:function(e){return c(e)}},"Log Out")))}}]),n}(a.Component),Me=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={users:null,searchWord:"",filterLists:[],filterCards:[],isSearchOpenModal:!1},e.loadUsers=function(){},e.onCloseSearchModal=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.setState({isSearchOpenModal:!1})},e.handleChange=function(t){var n=t.target.value;e.setState({searchWord:n},(function(){return e.onSearch()}))},e.onSearch=function(){var t=e.state.searchWord,n=e.props,a=n.currBoard,r=n.boards;if(t.length){if(a){var o=[];a.cardLists.forEach((function(e){e.title.toLowerCase().includes(t.toLowerCase())&&(e.boardId=a._id,e.boardTitle=a.title,o.push(e))}));var c=[];a.cardLists.forEach((function(e){e.cards.forEach((function(n){n.text.toLowerCase().includes(t.toLowerCase())&&(n.boardId=a._id,n.boardTitle=a.title,n.cardListId=e.id,n.cardListTitle=e.title,c.push(n))}))})),e.setState({filterLists:o,filterCards:c})}else if(r){var i=r.filter((function(e){return e.title.toLowerCase().includes(t.toLowerCase())}));return i.length||(i=r),void e.setState({filterBoards:i})}}else e.setState({filterBoards:[],filterLists:[],filterCards:[],filterUsers:[]})},e.onBoardClick=function(t){e.props.history.push("/board/".concat(t)),e.setState({isSearchOpenModal:!1})},e.onCardClicked=function(t){e.props.history.push("/board/".concat(e.props.currBoard._id,"/").concat(t)),e.setState({isSearchOpenModal:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onCloseSearchModal,!1),document.addEventListener("keydown",this.onCloseSearchModal,!1),this.loadUsers()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onCloseSearchModal,!1),document.removeEventListener("keydown",this.onCloseSearchModal,!1)}},{key:"openSearchModal",value:function(){this.setState({isSearchOpenModal:!0})}},{key:"render",value:function(){var e=this,t=this.state,n=t.searchWord,a=t.filterLists,o=t.filterCards,c=t.filterBoards,i=t.isSearchOpenModal,s=this.props,l=(s.currBoard,s.history,this.onCardClicked);return c&&c.filter((function(e){return e.isStarred})),r.a.createElement("div",{ref:function(t){return e.node=t},className:" nav-search-result-container flex column"},r.a.createElement("input",{onClick:function(){return e.openSearchModal()},autoComplete:"off",onSubmit:function(){return e.onSearch},className:"card-search",type:"text",value:n,name:"keyword",placeholder:"Search",onChange:this.handleChange}),r.a.createElement("div",{className:"nav-search-result ".concat(i?"open-modal":""," flex column")},c&&Boolean(c.length)&&r.a.createElement("div",null,r.a.createElement("h3",{className:"result-header"},"Board results"),r.a.createElement("div",{className:"search-results"},c.map((function(t){return r.a.createElement("div",{key:t._id,className:"result-preview",onClick:function(){return e.onBoardClick(t._id)}},r.a.createElement("div",{className:"board-btn"}),r.a.createElement("div",{className:"header"},t.title))})))),!Boolean(a.length)&&!Boolean(o.length)&&c&&!Boolean(c.length)&&r.a.createElement("div",{className:"empty-search-massage"},r.a.createElement("div",{className:"search"}),r.a.createElement("div",null,"Search")),o&&Boolean(o.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"result-header"}),r.a.createElement("div",{className:"search-results"},o.map((function(e){return r.a.createElement("div",{className:"result-preview",onClick:function(){return l(e.id)}},r.a.createElement("div",{className:"card result-icon"}),r.a.createElement("div",{className:"text-result"},r.a.createElement("div",{className:"header"},e.text),r.a.createElement("div",{className:"conjunction"},"in"),r.a.createElement("div",{className:"conjunction"},e.cardListTitle)))}))))))}}]),n}(r.a.Component),xe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={filteredUsers:null,isAlreadyInvitesShown:!1,keyword:""},e.onCloseInviteMenu=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.props.onCloseInviteMenu()},e.inputHandler=function(t){var n=t.target;if(e.setState({keyword:n.value}),n.value){var a=n.value.toLowerCase(),r=e.props.users.filter((function(e){return e.userName.includes(a.toLowerCase())}));e.setState({filteredUsers:r})}else e.setState({filteredUsers:null})},e.filterUsers=function(t){var n=e.props.users;t=t.toLowerCase();var a=n.filter((function(e){return e.userName.includes(t.toLowerCase())}));e.setState({filteredUsers:a})},e.onInvite=function(t){if(-1!==e.props.activeBoard.members.findIndex((function(e){return e._id===t})))return e.setState({isAlreadyInvitesShown:!0}),void setTimeout((function(){e.setState({isAlreadyInvitesShown:!1})}),1500);var n={invitedUserId:t,sender:e.props.loggedUser.userName,collabBoardId:e.props.activeBoard._id,createdAt:Date.now()};L.emit("user invite",n)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.loadUsers(),document.addEventListener("mousedown",this.onCloseInviteMenu,!1),document.addEventListener("keydown",this.onCloseInviteMenu,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onCloseInviteMenu,!1),document.removeEventListener("keydown",this.onCloseInviteMenu,!1)}},{key:"componentDidUpdate",value:function(e){var t=this;e.users!==this.props.users&&setTimeout((function(){t.filterUsers(t.state.keyword)}),1500)}},{key:"render",value:function(){var e=this,t=this.state,n=t.filteredUsers,a=t.isAlreadyInvitesShown,o=this.props.isInviteModalOpen;return r.a.createElement("div",{ref:function(t){return e.node=t},className:"invite-members-modal ".concat(o?"modal-open":""," flex column align-center")},r.a.createElement("div",{className:"invite-header"},r.a.createElement("h3",null,"Invite to collaborate")),a&&r.a.createElement("p",null,"User already a member!"),r.a.createElement("input",{type:"text",placeholder:"Enter userName to invite",onKeyUp:this.inputHandler}),n&&r.a.createElement("div",{className:"invite-users-list flex column align-center"},n.map((function(t,n){return r.a.createElement("div",{key:n,className:"user-to-invite flex align-center "},r.a.createElement("span",{className:"nav-user-profile",style:{backgroundImage:"url("+"".concat(t.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),r.a.createElement("div",{className:"flex column",style:{marginLeft:"10px"}},r.a.createElement("h4",{style:{marginBottom:"3px"}},t.fullName),t.isLogIn&&r.a.createElement("div",{className:"user-status flex align-center"},r.a.createElement("h5",{style:{color:"green"}},"Online")),!t.isLogIn&&r.a.createElement("div",{className:"user-status flex align-center"},r.a.createElement("h5",{style:{color:"gray"}},"Offline"))),r.a.createElement("button",{className:"user-invite-btn",onClick:function(){return e.onInvite(t._id)}},"Invite"))}))))}}]),n}(a.Component),je={loadUsers:P,getUser:R},Le=Object(p.b)((function(e){return{users:e.user.users,loggedUser:e.user.loggedInUser,activeBoard:e.boardApp.currBoard}}),je)(xe),De=n(12),Ae=n.n(De),Ue=n(29),Te="#3742fa",Ie="#ff4757",Fe="#1e90ff",_e="#ff6348",Pe="#2ed573",He="#ffa502",Re="rgb(255, 124, 67)",We="rgb(255, 166, 0)",Ve="rgb(24, 170, 225)",ze="rgb(238, 83, 141)",Je=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).reducerJoinTaskByUser=function(){var t=e.props.currBoard;if(t)return t.cardLists.reduce((function(e,t){return t.cards.forEach((function(t){t.checkList.forEach((function(t){if(t.isDone&&t.doneBy){var n=Ae()(t.doneTime).format("MMM Do");e[t.doneBy.userName]||(e[t.doneBy.userName]={}),e[t.doneBy.userName][n]?e[t.doneBy.userName][n].push(t):e[t.doneBy.userName][n]=[t]}}))})),e}),{})},e.graphColors=function(){return[Te,Ie,Fe,_e,Pe,He,Re,We,Ve,ze]},e.updateUsersDoneTaskData=function(){var t={},n=Date.now();t.labels=[],t.datasets=[];for(var a=5;a>0;a--){t.labels.push(Ae()(n-864e5*(a-1)).format("MMM Do"))}var r=e.reducerJoinTaskByUser(),o=e.graphColors(),c=function(e){var n=t.labels.map((function(t){return r[e][t]?r[e][t].length:0})),a=o.splice(0,1)[0];t.datasets.push({label:e,backgroundColor:a,borderColor:a,borderWidth:1,hoverBackgroundColor:a,hoverBorderColor:a,data:n})};for(var i in r)c(i);return t},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.updateUsersDoneTaskData();return r.a.createElement("div",{className:"chart-bar"},r.a.createElement("h2",null,"Done tasks by user"),r.a.createElement(Ue.a,{data:e,options:{maintainAspectRatio:!1}}))}}]),n}(a.Component),qe=[Te,Ie,Fe,_e,Pe,He,Re,We,Ve,ze],Ke=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).updateData=function(){var t=e.props.currBoard,n={labels:[],datasets:null};n.labels=t.cardLists.map((function(e){return e.title}));var a=t.cardLists.map((function(e){return e.cards.length}));return n.datasets=[{data:a,backgroundColor:qe,hoverBackgroundColor:qe}],n},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"chart-pay"},r.a.createElement("h2",null,"Cards per list"),r.a.createElement(Ue.c,{data:this.updateData()}))}}]),n}(a.Component),Ge={labels:["23/5","24/5","25/5","26/5","27/5","28/5","29/5"],datasets:[{label:"Todo",fill:!1,lineTension:.5,backgroundColor:Ve,borderColor:Ve,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:Ve,pointBackgroundColor:Ve,pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:Ve,pointHoverBorderColor:Ve,pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[3,2,5,1,6,5,2]},{label:"In progress",fill:!1,lineTension:.5,backgroundColor:ze,borderColor:ze,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:ze,pointBackgroundColor:ze,pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:ze,pointHoverBorderColor:ze,pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[3,4,1,3,4,5,6]}]},Xe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"chart-line"},r.a.createElement("h2",null,"Task amount to day"),r.a.createElement(Ue.b,{data:Ge}))}}]),n}(a.Component),Qe=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isCartModalOpen:!1},e.closeStatisticModal=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.setState({isCartModalOpen:!1})},e.onChartClick=function(){e.setState((function(e){return{isCartModalOpen:!e.isCartModalOpen}}))},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeStatisticModal,!1),document.addEventListener("keydown",this.closeStatisticModal,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeStatisticModal,!1),document.removeEventListener("keydown",this.closeStatisticModal,!1)}},{key:"render",value:function(){var e=this,t=this.state.isCartModalOpen,n=this.props.currBoard;return r.a.createElement("div",{className:"chart-container "},r.a.createElement("div",{className:"nav-chart-btn chart",onClick:this.onChartClick}),r.a.createElement("div",{className:"screen  ".concat(t?"modal-open":""," ")},r.a.createElement("div",{ref:function(t){return e.node=t},className:"chart-modal flex wrap"},r.a.createElement(Ke,{currBoard:n}),r.a.createElement(Xe,{currBoard:n}),r.a.createElement(Je,{currBoard:n}))))}}]),n}(a.Component),$e=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),{})(Qe),Ye={notification:function(){var e=new Audio("https://res.cloudinary.com/dt3cfrjpr/video/upload/v1590757355/messenger_d1vdx5.mp3");e.volume=.15,e.play()}};var Ze,et=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isMenuActive:!1,isInviteModalOpen:null,isNotificationModalOpen:!1},e.closingCode=Object(v.a)(h.a.mark((function t(){var n,a;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.loggedUser,(a=Object(te.a)({},n)).isLogIn=!1,t.next=5,e.props.update(a);case 5:return L.emit("user logged-out"),t.abrupt("return",null);case 7:case"end":return t.stop()}}),t)}))),e.socketSubscribers=function(){L.off("user-invite-".concat(e.props.loggedUser._id)),L.off("user-card-assign-".concat(e.props.loggedUser._id)),e.props.loggedUser&&(L.on("user-invite-".concat(e.props.loggedUser._id),(function(t){e.notifiBoardCollab(t)})),L.on("user-card-assign-".concat(e.props.loggedUser._id),(function(t){e.notifiCardAssign(t)})))},e.notifiBoardCollab=function(t){e.props.loggedUser.notifications.unshift({data:"Exciting news! ".concat(t.sender," invited you to collaborate in a board."),createdAt:Ae()(t.createdAt).fromNow(),collabBoardId:t.collabBoardId,isRead:!1,type:"board-collab"}),e.props.update(e.props.loggedUser),Ye.notification()},e.notifiCardAssign=function(t){e.props.loggedUser.notifications.unshift({data:"Congratz! you have new card assign by ".concat(t.assingedBy,"."),type:"card-assign",isRead:!1,cardId:t.cardId,boardId:t.boardId}),e.props.update(e.props.loggedUser),Ye.notification()},e.onMenuClick=function(){e.setState((function(e){return{isMenuActive:!e.isMenuActive}}))},e.onCloseMenu=function(t){var n;t.stopPropagation(),(null===(n=e.node)||void 0===n?void 0:n.contains(t.target))&&27!==t.keyCode||e.setState({isMenuActive:!1})},e.onCloseInviteMenu=function(){e.setState({isInviteModalOpen:!1})},e.onCloseNotificationMenu=function(){e.setState({isNotificationModalOpen:!1})},e.onViewCardNotification=function(t){var n=e.props.loggedUser,a=Object(te.a)({},n);a.notifications=a.notifications.filter((function(e,n){return n!==t})),e.props.update(a),e.onCloseNotificationMenu()},e.onUserNotificationClick=function(){e.setState((function(e){return{isNotificationModalOpen:!e.isNotificationModalOpen}}))},e.onInviteMember=function(){e.setState((function(e){return{isInviteModalOpen:!e.isInviteModalOpen}}))},e.onPageChange=function(){e.setState({isMenuActive:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("mousedown",this.onCloseMenu,!1),document.addEventListener("keydown",this.onCloseMenu,!1),window.onbeforeunload=this.closingCode,L.setup(),L.on("newuserconnect",(function(){e.props.loadUsers()})),L.on("user-disconnected",(function(){e.props.loadUsers()})),L.on("user-disconnected-ui",(function(){e.props.loadUsers()})),this.props.getUser().then((function(){e.socketSubscribers(),e.props.loggedUser?e.props.setBoards():e.props.history.push("/")}))}},{key:"componentDidUpdate",value:function(e){e.loggedUser!==this.props.loggedUser&&this.socketSubscribers()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onCloseMenu,!1),document.removeEventListener("keydown",this.onCloseMenu,!1)}},{key:"render",value:function(){var e,t=this,n=this.state,a=n.isMenuActive,o=n.isNotificationModalOpen,c=n.isInviteModalOpen,i=this.props,s=i.boards,l=i.activeBoard,u=i.history,d=i.loggedUser,p=this.onCloseInviteMenu,f=this.onInviteMember,h=this.onCloseNotificationMenu,v=this.onPageChange;return d&&(e=d.notifications.filter((function(e){return!e.isRead}))),d?r.a.createElement("nav",{className:"nav-bar flex align-center space-between"},!l&&r.a.createElement("div",{className:"img-wrapper",onClick:function(){return t.props.history.push("/board")}},r.a.createElement("img",{className:"logo",width:"60px",alt:""})),r.a.createElement("div",{className:"nav-left-section flex align-center"},l&&r.a.createElement("div",{className:"board-button flex align-center justiry-center space-between cursor",onClick:this.onMenuClick},r.a.createElement("div",{style:{marginRight:"5px"},className:"board-btn"}),r.a.createElement("div",{className:"board-txt"},"Boards")),r.a.createElement("div",{className:"mobile-menu ".concat(a?"modal-open":""),ref:function(e){return t.node=e}},r.a.createElement(Ee,{onPageChange:v,history:u,isMenuActive:a,boards:s,currBoard:l,onCloseMenu:this.onCloseMenu}),l&&r.a.createElement(Se,{user:this.props.loggedUser,onInvite:f,history:u,board:l}),l&&r.a.createElement(Le,{isInviteModalOpen:c,onCloseInviteMenu:p})),r.a.createElement(Me,Object(m.a)({onPageChange:v,history:u,boards:s,currBoard:l},"history",u))),r.a.createElement("div",{className:"nav-right-section flex align-center"},l&&r.a.createElement($e,null),r.a.createElement("div",null,r.a.createElement("div",{className:"nav-notification-btn",onClick:this.onUserNotificationClick}),Boolean(e.length)&&r.a.createElement("div",{className:"notification-indicator"})),r.a.createElement(Be,{onCloseNotificationMenu:h,onViewCardNotification:function(e){return t.onViewCardNotification(e)},isNotificationModalOpen:o,history:u,user:d}),r.a.createElement(Oe,{user:d,history:u}))):""}}]),n}(r.a.Component),tt={setBoards:oe,setBoard:ie,getUser:R,update:W,loadUsers:P},nt=Object(p.b)((function(e){return{loggedUser:e.user.loggedInUser,boards:e.boardApp.boards,activeBoard:e.boardApp.currBoard}}),tt)(Object(i.f)(et)),at=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={user:null},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e,t=this,n=this.props.match.params.userId;D.getById(n).then((function(n){(e=n)?t.setState({user:e}):t.props.history.push("/")}))}},{key:"render",value:function(){var e=this.state.user;return e?r.a.createElement("div",{className:"user-profile-container flex column"},r.a.createElement("h2",null,e.fullName,"'s Profile"),r.a.createElement("div",null),r.a.createElement("img",{className:"user-img",src:e.imgUrl}),r.a.createElement("p",null,"User Name: ",e.userName),r.a.createElement("p",null,"About:",e.about)):r.a.createElement("h3",null,"Loading...")}}]),n}(r.a.Component),rt={update:W},ot=Object(p.b)((function(e){return{}}),rt)(at),ct=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).onBoardClicked=function(t){e.props.history.push("/board/".concat(t))},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.setBoards(),this.props.getUser()}},{key:"render",value:function(){var e=this.props,t=e.boards,n=e.saveBoard,a=e.clearCurrBoard,o=t.filter((function(e){return e.isStarred}));return r.a.createElement("div",{className:"dashboard"},Boolean(o.length)&&r.a.createElement("section",{className:"boards-main-container"},r.a.createElement("h3",{className:"starred-title"},"Starred"),r.a.createElement("div",{className:"boards-container flex"},r.a.createElement(he,{boards:o,onBoardClicked:this.onBoardClicked,saveBoard:n,clearCurrBoard:a,editable:!0}))),r.a.createElement("section",{className:"boards-main-container"},r.a.createElement("h3",{className:"all-board-title"},"All Boards"),r.a.createElement("div",{className:"boards-container flex"},r.a.createElement(he,{boards:t,onBoardClicked:this.onBoardClicked,saveBoard:n,clearCurrBoard:a,addBoardOption:!0,editable:!0}))))}}]),n}(r.a.Component),it={setBoards:oe,saveBoard:le,clearCurrBoard:ce,setUser:V,getUser:R},st=Object(p.b)((function(e){return{boards:e.boardApp.boards,loggedUser:e.user.loggedInUser}}),it)(ct),lt=n(69);function ut(e){return r.a.createElement("div",{className:"card-details-actions flex column align-center"},r.a.createElement("h4",null,"Quick actions"),r.a.createElement("span",{className:"card-action-wrapper flex align-center space-between",onClick:e.onLabels},r.a.createElement("h5",{className:"action-title "},"Lables"),r.a.createElement("span",{className:"action-label"}," ")),r.a.createElement("span",{className:"card-action-wrapper flex align-center space-between",onClick:e.onImages},r.a.createElement("h5",{className:"action-title "},"Images"),r.a.createElement("span",{className:"action-image"}," ")),r.a.createElement("span",{className:"card-action-wrapper flex align-center space-between",onClick:e.onTodoAction},r.a.createElement("h5",{className:"action-title "},"New todo item"),r.a.createElement("span",{className:"action-todos "}," ")),r.a.createElement("span",{className:"card-action-wrapper flex align-center space-between",onClick:function(){return e.openDatePicker()}},r.a.createElement("h5",{className:"action-title "},"Set due-Date"),r.a.createElement("span",{className:"action-calendar "}," ")))}function dt(e){var t=e.card,n=e.user;return r.a.createElement("div",{className:"card-msgs-container"},t.comments.map((function(t,a){return r.a.createElement("div",{key:a,className:"card-comment-wrapper flex align-start",style:{marginLeft:"44px",width:"370px"}},n.imgUrl&&r.a.createElement("div",{className:"user-profile-comment",style:{backgroundImage:"url("+"".concat(t.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",minWidth:"30px"}}),!n.imgUrl&&r.a.createElement("h3",{style:{marginLeft:"0px",marginRight:"15px",width:"30px",height:"30px"},className:"card-user-profile flex justify-center align-center"},n.fullName.charAt(0)),r.a.createElement("div",{style:{width:"100%",marginBottom:"10px"},className:"flex column align-start"},r.a.createElement("p",{className:"card-msg-txt"},t.txt," "),r.a.createElement("div",{className:"flex align-center"},r.a.createElement("p",{className:"card-msg-time"},Ae()(t.createdAt).fromNow()," "),r.a.createElement("button",{className:"card-msg-delete",onClick:function(){return e.deleteComment(a)}},"Delete"))))})))}var mt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={userMsg:"",isTypeActive:!1},e.onUserType=function(t){var n=t.target,a=e.props.card.id;e.setState({userMsg:n.value}),clearInterval(Ze),L.emit("user typing",{id:a,status:!0}),Ze=setTimeout((function(){L.emit("user typing",{id:a,status:!1})}),550)},e.onSubmit=function(t){t.preventDefault();var n=e.props,a=n.card,r=n.board,o=n.user,c=e.state.userMsg;if(c){var i={userName:o.userName,txt:c,imgUrl:o.imgUrl,createdAt:Date.now()};a.comments.unshift(i),e.props.saveBoard(r).then((function(){return L.emit("board updated",r._id)})),e.setState({userMsg:""})}},e.deleteComment=function(t){var n=e.props,a=n.card,r=n.board;a.comments.splice(t,1),e.props.saveBoard(r)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.card.id;L.on("user-type-".concat(t),(function(t){e.setState({isTypeActive:t})}))}},{key:"componentWillUnmount",value:function(){var e=this.props.card.id;L.off("user-type-".concat(e))}},{key:"render",value:function(){var e=this.props,t=e.currUser,n=e.card,a=(e.board,this.state),o=a.userMsg,c=a.isTypeActive;return t?r.a.createElement("div",{className:"card-comments"},r.a.createElement("div",{className:"flex align-center",style:{marginBottom:"15px"}},r.a.createElement("span",{className:"comment"}),r.a.createElement("h4",null,"Comments")),r.a.createElement("div",{className:"card-add-comment flex align-center",style:{marginLeft:"40px",marginBottom:"15px"}},t.imgUrl&&r.a.createElement("div",{className:"self-profile-comment",style:{backgroundImage:"url("+"".concat(t.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}}),!t.imgUrl&&r.a.createElement("h3",{style:{marginLeft:"0px",marginRight:"15px"},className:"card-user-profile flex justify-center align-center"},t.fullName.charAt(0)),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{className:"user-text-input",type:"text",placeholder:t.userName+", whats on your mind?",onChange:this.onUserType,value:o})),c&&r.a.createElement("span",{className:"pulse"})),r.a.createElement(dt,{card:n,user:t,deleteComment:this.deleteComment})):""}}]),n}(a.Component),pt={saveBoard:le},ft=Object(p.b)((function(e){return{currUser:e.user.loggedInUser}}),pt)(mt),ht=n(114),vt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isEditMode:!1,description:"",dynamicClass:""},e.onDescClicked=function(){e.setState({isEditMode:!0})},e.onTextAreaLeave=function(){var t=e.props,n=t.card,a=t.board;e.setState({isEditMode:!1,dynamicClass:""},(function(){n.description=e.state.description,e.props.saveBoard(a)}))},e.onTextFocus=function(){e.setState({dynamicClass:"text-area"})},e.onDescEdit=function(t){var n=t.target;e.setState({description:n.value})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.card;e.board;this.setState({description:t.description})}},{key:"moveCaretAtEnd",value:function(e){var t=e.target.value;e.target.value="",e.target.value=t}},{key:"render",value:function(){var e,t=this.props.card,n=this.state,a=n.isEditMode,o=n.description,c=n.dynamicClass;return r.a.createElement("div",{className:"card-details-description"},r.a.createElement("div",{className:"flex "},r.a.createElement("span",{className:"text"}),r.a.createElement("h4",null,"Description")),!a&&r.a.createElement("p",{onClick:this.onDescClicked},t.description||"Add some details about this card"),a&&r.a.createElement(ht.a,(e={className:c,onFocus:this.onTextFocus,onBlur:this.onTextAreaLeave,type:"text",autoFocus:!0,value:o,placeholder:"Add more details about this card...",onChange:this.onDescEdit},Object(m.a)(e,"onFocus",this.moveCaretAtEnd),Object(m.a)(e,"spellCheck",!1),e)))}}]),n}(a.Component),bt={saveBoard:le},gt=Object(p.b)(null,bt)(vt);function Et(e){var t=e.board,n=e.card,a=e.opacity;return r.a.createElement("div",{className:"add-card-member-modal ".concat(a," flex align-center")},r.a.createElement("div",{className:"nav-board-members flex align-center"},t.members.map((function(t,a){var o="";0===a&&(o="first-member");var c=n.members.findIndex((function(e){return e._id===t._id}));return t.imgUrl?r.a.createElement("div",{key:a,className:"flex column align-center"},-1!==c&&r.a.createElement("div",{style:{marginLeft:"".concat(a?"-2px":"")},className:"member-overlay"}," "),r.a.createElement("div",{className:o+" board-member",style:{backgroundImage:"url("+"".concat(t.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},onClick:function(){return e.addMember(t)}},r.a.createElement("div",{className:"board-member-tooltip"},r.a.createElement("p",null,t.fullName)))):r.a.createElement("h3",{onClick:function(){return e.addMember(t)},className:"card-user-profile flex justify-center align-center"},t.fullName.charAt(0))}))))}var yt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isAddMemberActive:!1,isMouseHoverUser:!1},e.onAddMember=function(){e.setState((function(e){return{isAddMemberActive:!e.isAddMemberActive}}))},e.addMember=function(t){var n=e.props,a=n.card,r=n.board,o=n.user;if(-1===a.members.findIndex((function(e){return e._id===t._id}))){a.members.push(t),e.props.saveBoard(r),e.props.setBoard(r._id);var c={assignedUserId:t._id,assingedBy:o.userName,cardId:a.id,boardId:r._id};L.emit("user card assign",c)}},e.onMouseEnter=function(){e.setState({isMouseHoverUser:!0})},e.onMouseLeave=function(){e.setState({isMouseHoverUser:!1})},e.onRemoveCardUser=function(t,n){n.stopPropagation();var a=e.props,r=a.card,o=a.board;r.members.splice(t,1),e.props.saveBoard(o)},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.card,a=t.history,o=t.board,c=t.showModal,i=this.state,s=i.isAddMemberActive,l=i.isMouseHoverUser;return r.a.createElement("div",{style:{marginBottom:"30px",marginLeft:"42px"},className:"flex column"},r.a.createElement("h4",{className:"card-members-header"},"Card members"),r.a.createElement("div",{className:"card-members flex align-center"},r.a.createElement(Et,{opacity:s||c?"opacity-one":"",card:n,board:o,history:a,addMember:this.addMember}),r.a.createElement("button",{className:"card-member-invite '}",onClick:this.onAddMember,style:{backgroundColor:"".concat(s?"rgba(110, 253, 141, 0.432)":"rgba(142, 176, 248, 0.267)")}},s?"Done":"+Add"),n.members.map((function(t,n){return t.imgUrl?r.a.createElement("div",{key:n,className:"profile-tooltip-wraper"},r.a.createElement("div",{className:"card-member",style:{backgroundImage:"url("+"".concat(t.imgUrl)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},onClick:function(){return a.push("/user/".concat(t._id))},onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},l&&r.a.createElement("button",{onClick:function(t){return e.onRemoveCardUser(n,t)},className:"card-member-remove"})),r.a.createElement("div",{className:"card-member-tooltip"},r.a.createElement("p",null,t.fullName))):r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"card-user-profile flex justify-center align-center",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave}," ",t.fullName.charAt(0)),l&&r.a.createElement("button",{onClick:function(t){return e.onRemoveCardUser(n,t)},className:"card-member-remove"}),r.a.createElement("div",{className:"card-member-tooltip"},r.a.createElement("p",null,t.fullName)))}))))}}]),n}(a.Component),Ct={saveBoard:le,setBoard:ie},kt=Object(p.b)(null,Ct)(yt),wt=n(112),Nt=(n(265),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={date:new Date,timeStamp:""},e.onChange=function(t){return e.setState({date:t},e.formatDate)},e.formatDate=function(){var t=e.state.date.getTime();e.setState({timeStamp:t})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.state.timeStamp,n=this.props.isShown;return r.a.createElement("div",{className:"card-calendar-container ".concat(n?"calendar-fade":"")},r.a.createElement(wt.a,{onChange:this.onChange,value:this.state.date,minDate:new Date}),t&&r.a.createElement("div",{className:"flex justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.253)"}},r.a.createElement("button",{className:"date-confirm",onClick:function(){return e.props.onDatePicked(t)}},"Confirm")))}}]),n}(a.Component)),Bt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isComplete:!1,diffDays:null,timeStamp:null},e.onComplete=function(){var t=e.props.board;e.setState((function(e){return{isComplete:!e.isComplete}}),(function(){return console.log(e.state.isComplete)})),e.props.saveBoard(t)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getDiffDays()}},{key:"componentDidUpdate",value:function(){var e=this.props.card;this.state.timeStamp!==e.dueDate&&this.getDiffDays()}},{key:"getDiffDays",value:function(){var e=this.props.card,t=Math.ceil((e.dueDate-Date.now())/864e5);this.setState({diffDays:t,timeStamp:e.dueDate})}},{key:"render",value:function(){var e=this.props.card,t=this.state,n=t.isComplete,a=t.diffDays;return r.a.createElement("div",{className:"card-due-date-container"},r.a.createElement("div",{className:"flex "},r.a.createElement("span",{className:"due-date"}),r.a.createElement("h4",null,"Due Date")),r.a.createElement("div",{style:{marginLeft:"42.5px",marginTop:"18px"},className:"flex align-center"},r.a.createElement("span",{className:n?"due-date-checkbox-complete":"due-date-checkbox",onClick:this.onComplete}," "),r.a.createElement("p",null,Ae()(e.dueDate).format("MMM Do")),n&&r.a.createElement("p",{className:"due-date-complete flex align-center"},"Complete"),!n&&r.a.createElement("p",{className:"flex align-center",style:{backgroundColor:"".concat(a>=4?"#F9A602":"#EC6B59"),marginLeft:"5px",fontWeight:"600",color:"white"}},r.a.createElement("span",{className:"dueDate"}),a," Days Left")))}}]),n}(r.a.Component),St={saveBoard:le},Ot=Object(p.b)(null,St)(Bt);function Mt(e){var t=e.url;return window.scrollTo({top:100,left:100,behavior:"smooth"}),r.a.createElement("div",{className:"img-screen flex align-center justify-center"},r.a.createElement("img",{src:t,width:"100%"}),r.a.createElement("span",{className:"img-modal-close-btn",onClick:function(){return e.onCloseImgModal()}}))}var xt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1,activeImg:null},e.onUpload=function(t){var n=e.props,a=n.board,r=n.card;e.setState({isLoading:!0});var o=[];ue(t).then((function(t){t.forEach((function(e){var t={fileName:e.original_filename,format:e.format,url:e.url};o.push(t)})),o.map((function(t){r.attachments.unshift(t),e.props.saveBoard(a).then(e.setState({isLoading:!1}))}))}))},e.onDelete=function(t){var n=e.props,a=n.card,r=n.board;a.attachments.splice(t,1),e.props.saveBoard(r)},e.onImgClick=function(t){e.setState({activeImg:t})},e.onCloseImgModal=function(){e.setState({activeImg:null})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.card,a=t.loggedUser,o=this.state,c=o.isLoading,i=o.activeImg,s=n.attachments;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card-details-attachments"},r.a.createElement("div",{className:"flex "},r.a.createElement("span",{className:"photo"}),r.a.createElement("h4",{className:"attachments-header"},"Images")),r.a.createElement("label",{style:{marginLeft:"42px"}}," Add",r.a.createElement("input",{type:"file",accept:"image/png, image/jpeg",onChange:this.onUpload,hidden:!0,multiple:!0})),r.a.createElement("div",{style:{marginTop:"15px",marginLeft:"42px"},className:"attachments-files-container flex align-center space-between"},s&&s.map((function(t,n){return r.a.createElement("div",{key:n,style:{marginBottom:"15px"},className:"flex column"},t.url&&r.a.createElement("img",{src:t.url,width:"150",onClick:function(){return e.onImgClick(t.url)}}),r.a.createElement("div",{className:"attachment-file-name-wrapper flex align-center space-between"},r.a.createElement("p",{className:"attachment-owner"},"Upload by - ",a.userName),r.a.createElement("button",{className:"attachment-delete-btn",onClick:function(){return e.onDelete(n)}},"Delete")))}))),c&&r.a.createElement("span",{style:{marginLeft:"55px"},className:"loading"})),i&&r.a.createElement(Mt,{onCloseImgModal:this.onCloseImgModal,url:i}))}}]),n}(a.Component),jt={saveBoard:le},Lt=Object(p.b)((function(e){return{activeBoard:e.boardApp.currBoard,loggedUser:e.user.loggedInUser}}),jt)(xt),Dt=(a.Component,function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isAddModalShown:!1,newTodoVal:"",isListFiltered:!1,openTodos:null,completedTodos:null,barFillWidth:null,toggleMode:"Hide"},e.getBarWidth=function(){var t=e.props,n=t.card,a=t.board,r=e.state,o=r.openTodos,c=r.completedTodos,i=o.length+c.length,s=c.length/i*100;e.setState({barFillWidth:s},(function(){n.todosBarWidth=s,e.props.saveBoard(a)}))},e.getTodosStatus=function(){var t=e.props,n=t.card,a=(t.board,n.checkList.filter((function(e){return!e.isDone}))),r=n.checkList.filter((function(e){return e.isDone}));e.setState({openTodos:a,completedTodos:r},(function(){e.getBarWidth()}))},e.onComplete=function(t){var n=e.props,a=(n.board,n.user);t.isDone=!t.isDone,t.doneBy={id:a._id,userName:a.userName,fullName:a.fullName},t.doneTime=Date.now(),e.getTodosStatus()},e.onAddTodo=function(){e.props.onAddTodo()},e.onHideComplete=function(){var t="";t="Hide"===e.state.toggleMode?"Show":"Hide",e.setState((function(e){return{isListFiltered:!e.isListFiltered,toggleMode:t}}))},e.inputHandler=function(t){var n=t.target;e.setState({newTodoVal:n.value})},e.onTodosScreen=function(){e.setState({isAddModalShown:!1}),e.props.onAddTodo()},e.onSubmit=function(t){t.preventDefault();var n=e.props,a=n.card,r=n.board,o=n.user,c={content:e.state.newTodoVal,creator:o.userName,isDone:!1,createdAt:Date.now()};a.checkList.unshift(c),e.props.saveBoard(r),e.setState({isAddModalShown:!1,newTodoVal:""}),e.getTodosStatus(),e.props.onAddTodo()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getTodosStatus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.card,a=(t.board,t.user,t.onActionTodo),o=this.state,c=(o.barFillWidth,o.toggleMode),i=this.state,s=i.newTodoVal,l=(i.isAddModalShown,i.isListFiltered),u=i.openTodos,d=i.completedTodos,m=[];return m=l?n.checkList.filter((function(e){return!e.isDone})):n.checkList,u?r.a.createElement("div",{className:"card-details-description"},r.a.createElement("div",{className:"flex align-center",style:{marginBottom:"10px"}},r.a.createElement("span",{className:"list"}),r.a.createElement("h4",null,"Todos"),r.a.createElement("button",{className:"todos-hide-complete-btn",onClick:this.onHideComplete},"".concat(c," (").concat(d.length,") complete items"))),r.a.createElement("div",{className:"todos-bar-wrapper"},r.a.createElement("span",{className:"todos-bar-fill",style:{width:"".concat(n.todosBarWidth,"%")}})),r.a.createElement("div",{style:{marginBottom:"15px"},className:"todo-add-wrapper flex align-center"},r.a.createElement("button",{className:"todo-add-btn",style:{marginLeft:"40px",padding:"0px"},onClick:this.onAddTodo},"+ item"),a&&r.a.createElement("div",{className:"screen",onClick:this.onTodosScreen},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{className:"todos-input",value:s,type:"text",style:{marginLeft:"20px"},onChange:this.inputHandler,autoFocus:!0,placeholder:"Add an item"})))),r.a.createElement("div",{className:"todos-container",style:{marginLeft:"40px",width:"320px"}},m.map((function(t,n){return r.a.createElement("div",{key:n,className:"flex align-center space-between"},r.a.createElement("div",{className:"todo-item flex align-center space-between"},r.a.createElement("div",{className:t.isDone?"todo-complete":"flex column"},r.a.createElement("h3",null,t.content),r.a.createElement("todoinfo",{className:"todo-info"},"Added by ",r.a.createElement("tagcolor",null,t.creator)," at ",r.a.createElement("tagcolor",null,Ae()(t.createdAt).fromNow()))),r.a.createElement("span",{className:t.isDone?"todo-checkbox-complete":"todo-checkbox",onClick:function(){return e.onComplete(t)}})))})))):"loading"}}]),n}(a.Component)),At={saveBoard:le},Ut=Object(p.b)(null,At)(Dt),Tt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={title:"",isErrorShown:!1},e.onOutSideClick=function(t){e.node.contains(t.target)||e.props.onClose()},e.onLabelClick=function(t,n){var a=e.props,r=a.card,o=a.board;if(-1!==r.labels.findIndex((function(e){return e.color===t})))return e.setState({isErrorShown:!0}),void setTimeout((function(){e.setState({isErrorShown:!1})}),1500);var c={title:n,color:t};r.labels.push(c),e.props.saveBoard(o)},e.inputHandler=function(t){var n=t.target;e.setState({title:n.value})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onOutSideClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onOutSideClick)}},{key:"render",value:function(){var e=this,t=this.state,n=(t.title,t.isErrorShown);return r.a.createElement("div",{ref:function(t){return e.node=t},className:"card-labels-modal flex column align-center"},r.a.createElement("h3",{className:"labels-header"},"Labels"),n&&r.a.createElement("h5",null,"This label already exist"),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#61BD4F"}},r.a.createElement("input",{placeholder:"Opt. Add label titles",value:"Frontend",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#61BD4F","Frontend")}},"Set")),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#F2D600"}},r.a.createElement("input",{value:"Backend Database",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#F2D600","Backend Database")}},"Set")),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#FF9F1A"}},r.a.createElement("input",{value:"Bugs",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#FF9F1A","Bugs")}},"Set")),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#EB5A46"}},r.a.createElement("input",{value:"TechDebt",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#EB5A46","TechDebt")}},"Set")),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#0079BF"}},r.a.createElement("input",{value:"Server",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#0079BF","Server")}},"Set")),r.a.createElement("div",{style:{marginBottom:"10px"},className:"flex space-between align-center"},r.a.createElement("div",{className:"card-label flex justify-center align-center",style:{width:"80%",height:"30px",backgroundColor:"#FF78CB"}},r.a.createElement("input",{value:"User management",onChange:this.inputHandler})),r.a.createElement("button",{className:"label-del-btn",onClick:function(){return e.onLabelClick("#FF78CB","User management")}},"Set")))}}]),n}(a.Component),It={saveBoard:le},Ft=Object(p.b)(null,It)(Tt),_t=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isDeleteBtnShow:!1},e.onKeyUp=function(t,n){var a=e.props,r=a.card;a.board,a.isShown;r.labels[t].title=n.target.innerText},e.onBlur=function(){var t=e.props.board;e.props.saveBoard(t)},e.onEnter=function(){e.setState({isDeleteBtnShow:!0})},e.onLeave=function(){e.setState({isDeleteBtnShow:!1})},e.onRemovelabel=function(t){var n=e.props,a=n.card,r=n.board;a.labels.splice(t,1),e.props.saveBoard(r)},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.card,a=(t.board,t.isShown),o=this.state.isDeleteBtnShow;return r.a.createElement("div",{className:"card-details-labels-container flex align-center"},n.labels.map((function(t,n){return r.a.createElement("div",{onMouseEnter:e.onEnter,onMouseLeave:e.onLeave,key:n,style:{backgroundColor:"".concat(t.color),minWidth:"50px",minHeight:"15px",marginRight:"10px",borderRadius:"5px",marginTop:"10px",padding:"2px",color:"white",fontSize:"12px",textAlign:"center",position:"relative"}},r.a.createElement("h4",{onBlur:e.onBlur,contentEditable:!0,suppressContentEditableWarning:!0,spellCheck:!1,onKeyUp:function(t){return e.onKeyUp(n,t)}},t.title),o&&r.a.createElement("button",{onClick:function(){return e.onRemovelabel(n)},className:"lable-remove"}))})),a&&r.a.createElement(Ft,{onClose:this.props.onClose,card:this.props.card,board:this.props.board}))}}]),n}(a.Component),Pt={saveBoard:le},Ht=Object(p.b)(null,Pt)(_t),Rt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currCard:null,currList:null,isCalendarActive:!1,isImagesShown:!1,isMembersModalShown:!1,isLabelsModalShown:!1,isActionTodoActive:!1},e.eventsHandler=function(e){e.stopPropagation()},e.getCurrCard=function(){var t,n,a=e.props,r=a.cardId;a.currBoard.cardLists.forEach((function(e){e.cards.forEach((function(a){a.id===r&&(t=a,n=e)}))})),e.setState({currCard:t,currList:n},(function(){t.attachments.length?e.setState({isImagesShown:!0}):t.attachments.length||e.setState({isImagesShown:!1})}))},e.openDatePicker=function(){e.setState((function(e){return{isCalendarActive:!e.isCalendarActive}}))},e.onImages=function(){e.setState((function(e){return{isImagesShown:!e.isImagesShown}}))},e.onMembers=function(){e.setState((function(e){return{isMembersModalShown:!e.isMembersModalShown}}))},e.onDatePicked=function(t){var n=e.state.currCard,a=e.props.currBoard;n.dueDate=t,e.setState({isCalendarActive:!1}),e.props.saveBoard(a)},e.onCloseCardDetails=function(){var t=e.props.currBoard;e.props.history.push("/board/".concat(t._id))},e.onCardTitle=function(t){var n=t.target;e.state.currCard.text=n.innerText},e.onTitleBlur=function(){var t=e.props.currBoard;e.props.saveBoard(t)},e.onLabels=function(){e.setState((function(e){return{isLabelsModalShown:!e.isLabelsModalShown}}))},e.onTodoAction=function(){e.setState({isActionTodoActive:!0})},e.onAddTodo=function(){e.setState((function(e){return{isActionTodoActive:!e.isActionTodoActive}}))},e.onLabelsClose=function(){e.setState((function(e){return{isLabelsModalShown:!e.isLabelsModalShown}}))},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.getCurrCard(),window.scrollTo({left:0,behavior:"smooth"})}},{key:"componentDidUpdate",value:function(e){this.props!==e&&this.getCurrCard()}},{key:"render",value:function(){var e=this.state,t=e.currCard,n=e.currList,a=e.isCalendarActive,o=e.isImagesShown,c=e.isMembersModalShown,i=e.isLabelsModalShown,s=e.isActionTodoActive,l=this.props,u=l.currBoard,d=l.loggedUser;return t?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"screen flex align-center justify-center",onClick:this.onCloseCardDetails}," "),r.a.createElement("div",{className:"card-details-content-wrapper"},r.a.createElement("div",{onClick:this.eventsHandler,className:"card-details-modal"},r.a.createElement("div",{className:"card-details-header flex space-between align-center"},r.a.createElement("div",{className:"flex align-center"},r.a.createElement("span",{className:"card-icon"}),r.a.createElement("p",{spellCheck:!1,contentEditable:!0,suppressContentEditableWarning:!0,className:"card-details-title",onBlur:this.onTitleBlur,onKeyUp:this.onCardTitle},t.text),r.a.createElement("p",{className:"card-list-parent"},"In list: ",r.a.createElement("span",null,n.title))),r.a.createElement("span",{className:"cancel",onClick:this.onCloseCardDetails})),r.a.createElement("div",{className:"card-details-content-wrapper flex"},r.a.createElement("div",{className:"card-details-content flex column"},r.a.createElement(Ht,{onClose:this.onLabelsClose,card:t,board:u,isShown:i}),r.a.createElement(kt,{user:d,history:this.props.history,card:t,board:u,showModal:c}),t.dueDate&&r.a.createElement(Ot,{card:t,board:u}),r.a.createElement(gt,{card:t,board:u}),(t.checkList.length>0||s)&&r.a.createElement(Ut,{onAddTodo:this.onAddTodo,onActionTodo:s,card:t,board:u,user:this.props.loggedUser}),o&&r.a.createElement(Lt,{card:t,board:u}),r.a.createElement(ft,{card:t,board:u,user:this.props.loggedUser})),r.a.createElement(ut,{onTodoAction:this.onTodoAction,onLabels:this.onLabels,openDatePicker:this.openDatePicker,onImages:this.onImages,onMembers:this.onMembers}),r.a.createElement(Nt,{card:t,onDatePicked:this.onDatePicked,isShown:a}))))):""}}]),n}(a.Component),Wt={saveBoard:le},Vt=Object(p.b)((function(e){return{loggedUser:e.user.loggedInUser}}),Wt)(Rt),zt=n(24);function Jt(e){var t=e.icon,n=e.num,a=e.color,o=e.isDone;return r.a.createElement("div",{className:"icon flex space-between"},r.a.createElement("div",{className:t}),r.a.createElement("div",{style:{color:a}},(o||0===o)&&o+"/",n))}function qt(e){var t,n,a=e.card,o=e.history;return a?r.a.createElement("div",{className:"wrap-icons"},r.a.createElement("div",{className:"card-icons flex space-between align-center"},a.dueDate&&r.a.createElement(Jt,{color:(n=a.dueDate,n-Date.now()<=864e5?"#e74c3c":n-Date.now()<=3456e5?"#e67e22":"#2ecc71"),icon:"clock-blue",num:function(e){return Math.floor((e-Date.now())/864e5)<0?"Today":Math.ceil((e-Date.now())/864e5)<=1?"Tomorrow":Math.floor((e-Date.now())/864e5)<7?Ae()(e).format("dddd"):Ae()(e).format("MMM DD")}(a.dueDate)}),r.a.createElement("div",{className:"items-wrap flex"},Boolean(a.comments.length)&&r.a.createElement(Jt,{icon:"conversation-blue",num:a.comments.length}),Boolean(a.checkList.length)&&r.a.createElement(Jt,{icon:"checklist-blue",num:a.checkList.length,isDone:(t=a.checkList,t.reduce((function(e,t){return t.isDone?e+1:e}),0))}))),r.a.createElement("div",{className:"members-placeholder"},Boolean(a.members.length)&&r.a.createElement(Se,{history:o,board:a,cardMemberMode:!0}))):"loading"}function Kt(e){var t=e.labels,n=e.card;return r.a.createElement("div",{className:"card-labels flex"},t.map((function(e,t){return r.a.createElement("div",{key:t,className:"card-label-style",style:{background:e.color,marginTop:"".concat(n.attachments.length>0?"0px":"5px")}})})))}var Gt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={cardTitle:e.props.cardHeader},e.closeCardMenu=function(t){27===t.keyCode&&e.props.closeMenu()},e.activeEditMode=function(t){t.stopPropagation(),e.setState({editTitleMode:!0})},e.handleChange=function(t){t.stopPropagation(),e.setState({title:t.target.value})},e.handleSubmit=function(t){t.preventDefault();var n=e.props.card;n.title=e.state.title,e.props.saveCard(n),e.setState({editTitleMode:!1}),e.props.closeMenu()},e.onSubmit=function(){e.props.offEditCardHeader(e.props.cardId,e.props.cardListId,e.state.cardTitle)},e.escFunction=function(t){13===t.keyCode&&e.onSubmit()},e.handleChange=function(t){var n=t.target.value;e.setState({cardTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.onSubmit()},e.handleBlur=function(){e.onSubmit()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"moveCaretAtEnd",value:function(e){var t=e.target.value;e.target.value="",e.target.value=t}},{key:"render",value:function(){var e=this.state.cardTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("textarea",{placeholder:"Edit title",onClick:function(e){return e.stopPropagation()},value:e,onChange:this.handleChange,autoFocus:!0,onFocus:this.moveCaretAtEnd,onBlur:this.handleBlur,spellCheck:"false"})))}}]),n}(a.Component),Xt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isMenuOpen:!1},e.closeBoardMenu=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.setState({isMenuOpen:!1})},e.openMenu=function(t){t.stopPropagation(),e.setState({isMenuOpen:!0})},e.onDeleteCard=function(t,n,a){a.stopPropagation();var r=e.props.currBoard,o=r.cardLists.find((function(e){return e.id===n})),c=o.cards.findIndex((function(e){return e.id===t}));o.cards.splice(c,1),e.props.saveBoard(r)},e.onCloseMenu=function(t){e.setState({isMenuOpen:!1}),e.props.onEditCardHeader(t)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeBoardMenu,!1),document.addEventListener("keydown",this.closeBoardMenu,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeBoardMenu,!1),document.removeEventListener("keydown",this.closeBoardMenu,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.cardId,a=t.cardListId,o=this.onDeleteCard,c=this.state.isMenuOpen;return r.a.createElement("div",{ref:function(t){return e.node=t},className:"card-menu-container"},r.a.createElement("div",{className:"menu-btn hidden",onClick:function(t){return e.openMenu(t)}}),c&&r.a.createElement("div",{className:"menu-options card-menu"},r.a.createElement("div",{onClick:function(t){return e.onCloseMenu(t)}},"Edit Title"),r.a.createElement("div",{onClick:function(e){return o(n,a,e)}},"Delete Card")))}}]),n}(a.Component),Qt={saveBoard:le},$t=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),Qt)(Xt),Yt=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isFocus:!1},e.onEditCardHeader=function(t){t.stopPropagation(),e.setState({isFocus:!0})},e.offEditCardHeader=function(t,n,a){if(t&&n){var r=JSON.parse(JSON.stringify(e.props.currBoard));r.cardLists.find((function(e){return e.id===n})).cards.find((function(e){return e.id===t})).text=a,e.setState({isFocus:!1}),e.props.saveBoard(r)}else e.setState({isFocus:!1})},e.showCard=function(e,t,n){t.push("/board/".concat(n._id,"/").concat(e))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.index,a=t.card,o=t.currBoard,c=t.cardListId,i=t.history,s=t.animation,l=this.showCard,u=this.offEditCardHeader,d=this.onEditCardHeader;return r.a.createElement(zt.b,{key:a.id,draggableId:a.id,index:n},(function(t,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",Object.assign({className:"card-preview drag flex column ".concat(n.isDragging?"isDragging":""," ").concat(s),onClick:function(){return l(a.id,i,o)},ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:Object(te.a)({userSelect:"none"},t.draggableProps.style)}),r.a.createElement($t,{cardId:a.id,onEditCardHeader:d,cardListId:c}),Boolean(a.attachments.length)&&r.a.createElement("img",{src:a.attachments[0].url,alt:""}),Boolean(a.labels.length)&&r.a.createElement(Kt,{card:a,histoy:i,labels:a.labels}),e.state.isFocus?r.a.createElement(Gt,{cardHeader:a.text,cardListId:c,cardId:a.id,offEditCardHeader:u}):r.a.createElement("div",{className:"card-text"},a.text),r.a.createElement(qt,{card:a})))}))}}]),n}(a.Component),Zt={saveBoard:le},en=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),Zt)(Yt),tn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={addCardForm:!1,newCardTitle:""},e.escFunction=function(t){27===t.keyCode&&e.setState({addCardForm:!1,newCardTitle:""})},e.openForm=function(){e.setState({addCardForm:!0})},e.handleChange=function(t){var n=t.target.value;e.setState({newCardTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.createNewCard()},e.handleBlur=function(){e.state.newCardTitle?e.createNewCard():e.setState({addCardForm:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"createNewCard",value:function(){var e={title:this.state.newCardTitle}.title;this.props.onAddCard(this.props.cardListId,e),this.setState({addCardForm:!1,newCardTitle:""})}},{key:"render",value:function(){var e=this.state,t=e.addCardForm,n=e.newCardTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card-preview flex justify-center align-center",onClick:this.openForm},t?r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Add card",value:n,onChange:this.handleChange,autoFocus:!0,onBlur:this.handleBlur})):r.a.createElement("div",null,"Add card")))}}]),n}(a.Component),nn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={isMenuOpen:!1},e.closeBoardMenu=function(t){t.stopPropagation(),e.node.contains(t.target)&&27!==t.keyCode||e.setState({isMenuOpen:!1})},e.openMenu=function(t){t.stopPropagation(),e.setState({isMenuOpen:!0})},e.onDeleteList=function(t,n){n.stopPropagation();var a=e.props.currBoard,r=a.cardLists,o=r.findIndex((function(e){return t===e.id}));r.splice(o,1),e.props.saveBoard(a)},e.onCloseMenu=function(t){e.setState({isMenuOpen:!1}),e.props.onEditListTitle(t)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.closeBoardMenu,!1),document.addEventListener("keydown",this.closeBoardMenu,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.closeBoardMenu,!1),document.removeEventListener("keydown",this.closeBoardMenu,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=(t.onEditListTitle,t.cardListId),a=this.onDeleteList,o=this.state.isMenuOpen;return r.a.createElement("div",{ref:function(t){return e.node=t},className:"list-menu-container"},r.a.createElement("div",{className:"menu-btn",onClick:function(t){return e.openMenu(t)}}),o&&r.a.createElement("div",{className:"menu-options list-menu "},r.a.createElement("div",{onClick:function(t){return e.onCloseMenu(t)}},"Edit Title"),r.a.createElement("div",{onClick:function(e){return a(n,e)}},"Delete List")))}}]),n}(a.Component),an={saveBoard:le},rn=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),an)(nn),on=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={cardListTitle:e.props.cardList.title},e.handleChange=function(t){t.stopPropagation(),e.setState({cardListTitle:t.target.value})},e.handleSubmit=function(t){t.preventDefault(),e.props.card.title=e.state.title,e.setState({editTitleMode:!1}),e.onSubmit()},e.onSubmit=function(){e.props.offEditListTitle(e.props.cardList.id,e.state.cardListTitle)},e.escFunction=function(t){27===t.keyCode&&e.onSubmit()},e.handleChange=function(t){var n=t.target.value;e.setState({cardListTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.onSubmit()},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.escFunction,!1),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.escFunction,!1),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"render",value:function(){var e=this.state.cardListTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Edit title...",value:e,onChange:this.handleChange,autoFocus:!0,onBlur:this.onSubmit})))}}]),n}(a.Component),cn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={addlistForm:!1,newlistTitle:"",isFocus:!1},e.onEditListTitle=function(t){t.stopPropagation(),e.setState({isFocus:!0})},e.offEditListTitle=function(t,n){if(t){var a=e.props.currBoard;a.cardLists.find((function(e){return e.id===t})).title=n,e.props.saveBoard(a),e.setState({isFocus:!1})}else e.setState({isFocus:!1})},e.escFunction=function(t){27===t.keyCode&&e.setState({addlistForm:!1,newlistTitle:""})},e.openForm=function(){e.setState({addlistForm:!0})},e.handleChange=function(t){var n=t.target.value;e.setState({newlistTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.createNewlist()},e.handleBlur=function(){e.state.newlistTitle?e.createNewlist():e.setState({addlistForm:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"createNewlist",value:function(){var e={title:this.state.newlistTitle};this.props.onAddList(e),this.setState({addlistForm:!1,newlistTitle:""})}},{key:"render",value:function(){var e=this,t=this.props,n=t.cardList,a=t.index,o=t.onAddCard,c=t.currBoard,i=t.history,s=t.animation,l=this.onEditListTitle,u=this.offEditListTitle;return r.a.createElement(zt.b,{key:n.id,draggableId:n.id,index:a},(function(t,a){return r.a.createElement("div",Object.assign({className:"wrap-card-list flex ".concat(s),key:n.id,ref:t.innerRef},t.draggableProps,t.dragHandleProps),r.a.createElement(zt.c,{droppableId:n.id,key:n.id,type:"card"},(function(t,a){return r.a.createElement("div",{className:"card-list-container flex column ".concat(a.isDraggingOver?"light":"")},r.a.createElement("div",{className:"title-content flex space-between "},e.state.isFocus?r.a.createElement(on,{listTitle:n.title,cardList:n,offEditListTitle:u}):r.a.createElement("h2",{className:"list-title"},n.title),r.a.createElement(rn,{onEditListTitle:l,cardListId:n.id})),r.a.createElement("div",Object.assign({className:"card-list"},t.droppableprops,{ref:t.innerRef}),n.cards.map((function(e,t){return r.a.createElement(en,{key:e.id,cardListId:n.id,currBoard:c,card:e,index:t,history:i,animation:s})})),t.placeholder),r.a.createElement(tn,{onAddCard:o,cardList:n,cardListId:n.id}))})))}))}}]),n}(a.Component),sn={saveBoard:le},ln=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),sn)(cn),un=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={addlistForm:!1,newlistTitle:""},e.escFunction=function(t){27===t.keyCode&&e.setState({addlistForm:!1,newlistTitle:""})},e.openForm=function(){e.setState({addlistForm:!0})},e.handleChange=function(t){var n=t.target.value;e.setState({newlistTitle:n})},e.handleSubmit=function(t){t.preventDefault(),e.createNewlist()},e.handleBlur=function(){e.state.newlistTitle?e.createNewlist():e.setState({addlistForm:!1})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"createNewlist",value:function(){this.state.newlistTitle;this.props.onAddList(this.state.newlistTitle),this.setState({addlistForm:!1,newlistTitle:""})}},{key:"render",value:function(){var e=this.state,t=e.addlistForm,n=e.newlistTitle;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"add-list",onClick:this.openForm},t?r.a.createElement("div",{className:"screen"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{placeholder:"Add list ...",value:n,onChange:this.handleChange,autoFocus:!0,onBlur:this.handleBlur}))):r.a.createElement("div",{className:"add-list-btn flex justify-center align-center"},r.a.createElement("div",{className:"plus-white"}))))}}]),n}(a.Component),dn=n(68),mn=n.n(dn),pn=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={animation:"animation",isScrolling:!1},e.getNewCard=function(e){return{id:mn()(),createdAt:Date.now(),creator:{},description:"",isStarred:!1,dueDate:null,members:[],covers:{id:"",imgUrl:"",isShown:!0},attachments:[],text:e,checkList:[],labels:[],comments:[]}},e.getNewList=function(e){return{id:mn()(),title:e,createdAt:Date.now(),creator:null,cards:[]}},e.onAddList=Object(v.a)(h.a.mark((function t(){var n,a,r=arguments;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:"",e.setState({animation:"animation"}),a=e.props.currBoard,a.cardLists.push(e.getNewList(n)),t.next=7,e.props.saveBoard(a);case 7:window.scrollTo({left:1e5,behavior:"smooth"});case 8:case"end":return t.stop()}}),t)}))),e.onAddCard=function(){var t=Object(v.a)(h.a.mark((function t(n){var a,r,o,c=arguments;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:"",e.setState({animation:"animation"}),r=e.props.currBoard,o=r.cardLists,o.find((function(e){return e.id===n})).cards.push(e.getNewCard(a)),t.next=8,e.props.saveBoard(r);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onDragEnd=function(t){if(e.setState({animation:""}),t.destination){var n=e.props.currBoard,a=n.cardLists,r=t.source,o=t.destination;switch(t.type){case"card":var c=a.find((function(e){return r.droppableId===e.id})),i=a.find((function(e){return o.droppableId===e.id})),s=c.cards,l=i.cards,u=s.splice(r.index,1),d=Object(lt.a)(u,1)[0];l.splice(o.index,0,d),e.props.saveBoard(n);break;case"list":var m=a.splice(r.index,1),p=Object(lt.a)(m,1)[0];a.splice(o.index,0,p),e.props.saveBoard(n)}}},e.onMouseDown=function(t){"card-lists flex "===t._targetInst.memoizedProps.className&&e.setState(Object(te.a)(Object(te.a)({},e.state),{},{isScrolling:!0}))},e.onMouseUp=function(){e.setState(Object(te.a)(Object(te.a)({},e.state),{},{isScrolling:!1}))},e.onMouseMove=function(t){var n=t.movementX;e.state.isScrolling&&window.scrollBy(-n,0)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.boardId;this.props.setBoard(t),L.on("board-updated-".concat(t),(function(t){e.setState({animation:"animation"}),e.props.setBoard(t)}))}},{key:"componentWillUnmount",value:function(){var e=this.props.match.params.boardId;L.off("board-updated-".concat(e)),this.props.clearCurrBoard()}},{key:"getBackground",value:function(e){return e.background.content?{backgroundImage:"url("+"".concat(e.background.content)+")",backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{background:e.background.color}}},{key:"render",value:function(){var e=this,t=this.onDragEnd,n=this.onAddList,a=this.onAddCard,o=this.props,c=o.currBoard,i=o.history,s=this.state.animation,l=this.props.match.params.cardId;if(!c)return r.a.createElement("div",null);var u=c.cardLists;return r.a.createElement("div",{className:"board-app-container"},r.a.createElement("div",{className:"board-background",style:this.getBackground(c)}),r.a.createElement("div",{className:"wrap-card-lists flex"},r.a.createElement(zt.a,{onDragEnd:function(e){return t(e)}},r.a.createElement(zt.c,{droppableId:"all-lists",direction:"horizontal",type:"list"},(function(t,n){return r.a.createElement("div",Object.assign({className:"card-lists flex ".concat(n.isDraggingOver?"light":"")},t.droppableProps,{ref:t.innerRef,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onMouseMove:e.onMouseMove}),u.map((function(e,t){return r.a.createElement(ln,{currBoard:c,onAddCard:a,key:e.id,cardList:e,index:t,history:i,animation:s})})),t.placeholder)}))),r.a.createElement(un,{onAddList:n})),l&&r.a.createElement(Vt,{currBoard:c,history:i,cardId:l}))}}]),n}(a.Component),fn={setBoards:oe,setBoard:ie,clearCurrBoard:ce,removeBoard:se,saveBoard:le},hn=Object(p.b)((function(e){return{currBoard:e.boardApp.currBoard}}),fn)(pn);var vn=function(){return r.a.createElement("div",null,r.a.createElement(nt,null),r.a.createElement("main",{className:"app-main-container"},r.a.createElement(i.c,null,r.a.createElement(i.a,{component:hn,path:"/board/:boardId/:cardId?"}),r.a.createElement(i.a,{component:ot,path:"/user/:userId"}),r.a.createElement(i.a,{component:st,path:"/board"}),r.a.createElement(i.a,{component:ee,path:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var bn=n(113),gn={boards:[],currBoard:null};var En={users:[],loggedInUser:null};var yn=n(19),Cn=n(111),kn=Object(yn.c)({boardApp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BOARDS":return Object(te.a)(Object(te.a)({},e),{},{boards:t.boards});case"SET_BOARD":return Object(te.a)(Object(te.a)({},e),{},{currBoard:t.board});case"RESET_BOARD":return Object(te.a)(Object(te.a)({},e),{},{currBoard:null});case"ADD_BOARD":return Object(te.a)(Object(te.a)({},e),{},{boards:[].concat(Object(bn.a)(e.boards),[t.board])});case"UPDATE_BOARD":return Object(te.a)(Object(te.a)({},e),{},{currBoard:t.board,boards:e.boards.map((function(e){return e._id===t.board._id?t.board:e}))});case"REMOVE_BOARD":return Object(te.a)(Object(te.a)({},e),{},{boards:e.boards.filter((function(e){return e._id!==t.boardId}))});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:En,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_USERS":return Object(te.a)(Object(te.a)({},e),{},{users:t.users});case"SET_USER":return Object(te.a)(Object(te.a)({},e),{},{loggedInUser:t.user});case"USER_REMOVE":return Object(te.a)(Object(te.a)({},e),{},{users:e.users.filter((function(e){return e._id!==t.userId}))});default:return e}}}),wn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||yn.d,Nn=Object(yn.e)(kn,wn(Object(yn.a)(Cn.a)));c.a.render(r.a.createElement(p.a,{store:Nn},r.a.createElement(J.a,null,r.a.createElement(vn,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[115,1,2]]]);
//# sourceMappingURL=main.26993e41.chunk.js.map